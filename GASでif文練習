function updateCell() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getActiveSheet();
  
  // B2セルから月を抽出
  const cellB2 = sheet.getRange("B2").getValue();
  const monthMatch = cellB2.match(/(\d+)月/);
  
  if (!monthMatch) {
    throw new Error("月の値が見つかりません");
  }
  
  // 抽出した月の値を取得（1つ前の月）
  const month = parseInt(monthMatch[1]) + 1;
  
  // 先週分シートを取得
  const lastWeekSheet = ss.getSheetByName("先週分");
  
  // ヘッダー行（3行目）から対象の列を探す
  const headerRange = lastWeekSheet.getRange(3, 1, 1, lastWeekSheet.getLastColumn());
  const headerValues = headerRange.getValues()[0];
  
  // 現在の年を取得
  const currentYear = new Date().getFullYear();
  
  // yyyy/mの形式で比較する文字列を作成
  const targetDate = `${currentYear}/${month}`;
  
  // 対象の列を検索
  let targetColumn = -1;
  for (let i = 0; i < headerValues.length; i++) {
    if (headerValues[i] === targetDate) {
      targetColumn = i + 1;
      break;
    }
  }
  
  if (targetColumn === -1) {
    throw new Error("対象の列が見つかりません");
  }
  
  // 48行目の値を取得
  const targetValue = lastWeekSheet.getRange(48, targetColumn).getValue();
  
  // C2セルに値を記入
  sheet.getRange("C2").setValue(targetValue);
}
