function transferDataFromSlidesToSheets() {
  // スライドとスプレッドシートのIDを設定
  const PRESENTATION_ID = ''; // スライドのIDを入力
  const SPREADSHEET_ID = ''; // スプレッドシートのIDを入力
  const SHEET_NAME = ''; // シート名を入力
  
  try {
    // スライドとスプレッドシートを取得
    const presentation = SlidesApp.openById(PRESENTATION_ID);
    const spreadsheet = SpreadsheetApp.openById(SPREADSHEET_ID);
    const sheet = spreadsheet.getSheetByName(SHEET_NAME);
    
    // 最初のスライドを取得（必要に応じてスライド番号を変更）
    const slide = presentation.getSlides()[0];
    
    // テーブルを取得（最初のテーブルを想定）
    const table = slide.getTables()[0];
    
    // データを格納する2次元配列
    const data = [];
    
    // テーブルの各行をループ
    for (let i = 0; i < table.getNumRows(); i++) {
      const row = [];
      const tableRow = table.getRow(i);
      
      // 各セルの値を取得
      for (let j = 0; j < table.getNumColumns(); j++) {
        const cell = tableRow.getCell(j);
        const text = cell.getText().asString().trim();
        
        // 数値の場合は変換
        const value = !isNaN(text) && text !== '' ? Number(text) : text;
        row.push(value);
      }
      
      data.push(row);
    }
    
    // メインデータ部分の更新（1行目から8行目まで）
    const mainDataRange = sheet.getRange(1, 1, 8, data[0].length);
    mainDataRange.setValues(data.slice(0, 8));
    
    // 数値フォーマットを設定
    // まずテキストとして設定
    mainDataRange.setNumberFormat('@');
    
    // 進捗率列（最終列）のフォーマットを設定
    const lastColumn = data[0].length;
    const percentageColumn = sheet.getRange(2, lastColumn, 7, 1); // 2行目から8行目まで
    percentageColumn.setNumberFormat('0.00%');
    
    // 前回比の列は整数フォーマット
    const previousCompareColumns = sheet.getRange(2, 4, 7, 1); // D列の数値
    previousCompareColumns.setNumberFormat('#,##0');
    
    Logger.log('データ転記が完了しました');
    
  } catch (error) {
    Logger.log('エラーが発生しました: ' + error);
  }
}

// トリガーを設定する関数
function createTimeDrivenTrigger() {
  ScriptApp.newTrigger('transferDataFromSlidesToSheets')
    .timeBased()
    .everyHours(1) // 1時間ごとに実行（必要に応じて調整）
    .create();
}

// 手動実行用の関数
function manualRun() {
  transferDataFromSlidesToSheets();
}
