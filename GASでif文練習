function updateColors() {
  const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = spreadsheet.getActiveSheet();
  
  // 1. ヘッダー部分の色をコピー
  copyColors(sheet, "C9:N9", "C10:N10");
  copyColors(sheet, "O9:Z9", "O10:Z10");
  copyColors(sheet, "AA9:AD9", "AA10:AD10");
  
  // 2. 左端の色を全体にコピー
  copyColors(sheet, "A11:A20", "C11:AD20");
  copyColors(sheet, "A21:A30", "C21:AD30");
  
  // 3. 来月の列に黄色を設定
  highlightNextMonth();
}

function copyColors(sheet, sourceRange, targetRange) {
  // 範囲を取得
  const source = sheet.getRange(sourceRange);
  const target = sheet.getRange(targetRange);
  
  // 背景色を取得
  const colors = source.getBackgrounds();
  
  // 背景色を設定
  target.setBackgrounds(colors);
}

function highlightNextMonth() {
  const sheet = SpreadsheetApp.getActiveSheet();
  
  // ヘッダー範囲から日付を取得
  const headerRange = sheet.getRange("C10:AD10");
  const headerValues = headerRange.getValues()[0];
  
  // 現在の日付から来月を計算
  const today = new Date();
  let nextMonth = today.getMonth() + 1;
  let nextYear = today.getFullYear();
  if (nextMonth > 11) {
    nextMonth = 0;
    nextYear++;
  }
  
  // 来月の列を探して黄色に設定
  for (let i = 0; i < headerValues.length; i++) {
    const headerDate = new Date(headerValues[i]);
    
    if (headerDate.getMonth() === nextMonth && headerDate.getFullYear() === nextYear) {
      const columnNumber = i + 3; // C列が3番目
      const targetRange = sheet.getRange(10, columnNumber, 21, 1);
      targetRange.setBackground("#FFFF00");
      
      Logger.log("Column highlighted: " + columnNumber);
      Logger.log("Range: " + targetRange.getA1Notation());
      break;
    }
  }
}
