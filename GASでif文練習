// トリガーのクリーンアップ関数
function cleanupRetryTriggers() {
  const triggers = ScriptApp.getProjectTriggers();
  triggers.forEach(trigger => {
    if (trigger.getHandlerFunction() === 'RemoveIRecordscol2' && 
        trigger.getUniqueId().startsWith('retry_')) {
      ScriptApp.deleteTrigger(trigger);
    }
  });
}

function RemoveIRecordscol2() {
  try {
    // 開始時に古いリトライトリガーをクリーンアップ
    cleanupRetryTriggers();
    
    // 既存の処理...
    
  } catch (error) {
    console.error(`エラーが発生しました: ${error.message}`);
    cleanupRetryTriggers(); // エラー時も念のためクリーンアップ
    setRetryTrigger('RemoveIRecordscol2', 5, 3);
    throw error;
  }
}
