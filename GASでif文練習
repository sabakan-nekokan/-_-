import tkinter as tk
from tkinter import filedialog
import pandas as pd
import os

def select_file():
    initial_dir = "C:/指定したフォルダーのパス"  # 指定したフォルダーのパスを設定
    while True:
        file_path = filedialog.askopenfilename(initialdir=initial_dir, filetypes=[("Excel files", "*.xlsx")])
        
        if not file_path:
            print("ファイル選択がキャンセルされました。")
            return None

        file_name = os.path.basename(file_path)
        
        if "ああああ" not in file_name:
            print("ファイル名が違います。'ああああ'を含むファイルを選択してください。")
            continue

        try:
            xls = pd.ExcelFile(file_path)
            
            if "いいいい" not in xls.sheet_names:
                print("'いいいい'という名前のシートが見つかりません。")
                continue

            df = pd.read_excel(file_path, sheet_name="いいいい")
            
            if "うううう" not in df.columns or "ええええ" not in df.columns:
                print("ヘッダーに'うううう'と'ええええ'が含まれていません。")
                continue

            print("正しいファイルが選択されました。")
            return df

        except Exception as e:
            print(f"ファイルの読み込み中にエラーが発生しました: {e}")
            continue

def main():
    root = tk.Tk()
    root.withdraw()  # メインウィンドウを非表示にする

    df = select_file()
    
    if df is not None:
        print("ファイルが正常に読み込まれました。")
        print(df.head())  # データフレームの最初の数行を表示
    else:
        print("ファイルの読み込みに失敗しました。")

if __name__ == "__main__":
    main()
