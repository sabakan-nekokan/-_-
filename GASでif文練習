import tkinter as tk
from tkinter import messagebox
import pandas as pd
import os
from openpyxl import load_workbook

class ExcelFileOpener:
    def __init__(self, root):
        self.root = root
        self.root.title("Excel File Opener")
        
        # ウィンドウサイズの設定
        self.root.geometry("400x200")
        
        # パスを読み込むExcelファイルの設定
        self.config_excel = "C:/path/to/config.xlsx"  # 設定ファイルのパス
        self.sheet_name = "Sheet1"                    # シート名
        self.cell = "A1"                             # パスが書かれているセル
        
        # UIの作成
        self.create_widgets()
        
    def create_widgets(self):
        # ラベルの作成
        label = tk.Label(self.root, text="以下のボタンをクリックしてファイルを開きます", pady=20)
        label.pack()
        
        # ボタンの作成
        open_button = tk.Button(self.root, text="ファイルを開く", command=self.open_file)
        open_button.pack(pady=20)
        
    def get_file_path_from_excel(self):
        try:
            # Excelファイルを読み込む
            wb = load_workbook(self.config_excel)
            ws = wb[self.sheet_name]
            file_path = ws[self.cell].value
            wb.close()
            return file_path
        except Exception as e:
            messagebox.showerror("エラー", f"Excelファイルの読み込みに失敗しました: {str(e)}")
            return None
    
    def open_file(self):
        # Excelからファイルパスを取得
        file_path = self.get_file_path_from_excel()
        
        if file_path and os.path.exists(file_path):
            try:
                # OSのデフォルトアプリケーションでファイルを開く
                os.startfile(file_path)
            except Exception as e:
                messagebox.showerror("エラー", f"ファイルを開けませんでした: {str(e)}")
        else:
            messagebox.showerror("エラー", "指定されたファイルが見つかりません")

def main():
    root = tk.Tk()
    app = ExcelFileOpener(root)
    root.mainloop()

if __name__ == "__main__":
    main()
